---
title: go语言推送文件到git
date: 2019-09-08 22:04:35
tags: 
    - git
    - go
categories: go
---

这段时间在找一个比较好用的Markdown编辑器软件，然后找到了Tea、Typora这两个，但是Tea的文件不是直接存储在文件夹中的，是存储在数据库里头的，所以就考虑使用Typora了，但是Typora没有同步文件的功能，只能单机使用，所以这两天就自己用go写了个自动推送文件到git的小工具。

<!-- more -->

需求比较简单，执行程序时，自动将目录下的所有文件推送到git上去。虽然需求比较简单，要做的事情相当少，但是在做的过程中发现，一个小东西想要做得比较完善，其实也还是有不少东西需要考虑的。

最初级版本，当然只是需要按顺序执行每个命令即可，刚开始为了快速测试，也就是这么实现了，在一切正常的情况下，也没问题，这样也没问题，能正常使用。但是在测试的时候，如果执行时有任何错误，程序就跑不下去了，有问题也不知道。然后就加上了异常处理，错误提示。

因为对go、git不太熟悉，在做的时候还是碰到不少问题，得去百度搜索的。

### 学习到的新知识

1.  在go语言中怎么执行外部程序

    ```go
    cmd := exec.Command(path, args...)	// 实例化一个执行程序，指定执行程序路径和参数
    cmd.Dir = ""	// Mac中执行的时候，默认目录是当前电脑登录用户的目录，所以需要执行执行文件夹
    output, err := cmd.CombinedOutput()	// 执行程序，并返回程序的输出内容
    result := string(output)	// 将输出内容转换为字符串
    ```

    cmd里还有一些其它的方法是执行命令的，CombinedOutput是要等一个命令执行完成后，才会返回执行结果。Run是直接执行，不返回执行结果，CombinedOutput其实内部也是有调用Run方法，只是加了异常的处理。

    在Mac中如果直接执行go语言编译后的执行文件，默认路径会在当前登录用户的文件夹下，所以执行本程序的时候，会提示当前目录不是git仓库，所以需要指定cmd的Dir

2.  字符串拆分

    ```go
    strings.Split("", "")
    ```

3.  字符串去除前后空行

    ```go
    strings.Trim("", "\n")
    ```

4.  获取当前执行文件的目录

    ```go
    dir, _ := filepath.Abs(filepath.Dir(os.Args[0]))
    ```

5.  在Mac中隐藏和显示隐藏文件的快捷键：`command+shift+.` ，这玩意以前不知道，老是得去命令行执行一串老长的命令，有这个快捷键可就方便多了。
